{"version":3,"sources":["CardField.tsx"],"names":["TextInputState","require","CardFieldNative","unsupportedMethodMessage","field","focusInput","ref","__DEV__","console","log","registerInput","unregisterInput","currentlyFocusedInput","CardField","onCardChange","onFocus","onBlur","cardStyle","placeholder","postalCodeEnabled","props","inputRef","onCardChangeHandler","event","card","nativeEvent","data","last4","expiryMonth","expiryYear","complete","brand","hasOwnProperty","postalCode","number","warn","onFocusHandler","focusedField","current","focus","UIManager","dispatchViewManagerCommand","blur","clear","inputRefValue","backgroundColor","borderColor","borderWidth","borderRadius","cursorColor","fontSize","placeholderColor","textColor","textErrorColor","fontFamily","expiration","cvc"],"mappings":"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","sourcesContent":["import type { CardFieldInput, Nullable } from '../types';\nimport React, {\n  forwardRef,\n  useCallback,\n  useImperativeHandle,\n  useLayoutEffect,\n  useRef,\n} from 'react';\nimport {\n  AccessibilityProps,\n  NativeSyntheticEvent,\n  requireNativeComponent,\n  UIManager,\n  StyleProp,\n  findNodeHandle,\n  ViewStyle,\n} from 'react-native';\nconst TextInputState = require('react-native/Libraries/Components/TextInput/TextInputState');\n\nconst CardFieldNative =\n  requireNativeComponent<CardFieldInput.NativeProps>('CardField');\n\nconst unsupportedMethodMessage = (field: string) =>\n  `${field} method is not supported. Consider to upgrade react-native version to 0.63.x or higher`;\n\nconst focusInput = (ref: React.MutableRefObject<any>) => {\n  if ('focusInput' in TextInputState) {\n    TextInputState.focusInput(ref);\n  } else {\n    if (__DEV__) {\n      console.log(unsupportedMethodMessage('focusInput'));\n    }\n  }\n};\n\nconst registerInput = (ref: React.MutableRefObject<any>) => {\n  if ('registerInput' in TextInputState) {\n    TextInputState.registerInput(ref);\n  } else {\n    if (__DEV__) {\n      console.log(unsupportedMethodMessage('registerInput'));\n    }\n  }\n};\n\nconst unregisterInput = (ref: React.MutableRefObject<any>) => {\n  if ('unregisterInput' in TextInputState) {\n    TextInputState.unregisterInput(ref);\n  } else {\n    if (__DEV__) {\n      console.log(unsupportedMethodMessage('unregisterInput'));\n    }\n  }\n};\n\nconst currentlyFocusedInput = () => {\n  if ('currentlyFocusedInput' in TextInputState) {\n    return TextInputState.currentlyFocusedInput();\n  } else {\n    if (__DEV__) {\n      console.log(unsupportedMethodMessage('currentlyFocusedInput'));\n    }\n  }\n};\n\n/**\n *  Card Field Component Props\n */\nexport interface Props extends AccessibilityProps {\n  style?: StyleProp<ViewStyle>;\n  postalCodeEnabled?: boolean;\n  cardStyle?: CardFieldInput.Styles;\n  placeholder?: CardFieldInput.Placeholders;\n  autofocus?: boolean;\n  onCardChange?(card: CardFieldInput.Details): void;\n  onBlur?(): void;\n  onFocus?(focusedField: Nullable<CardFieldInput.Names>): void;\n  testID?: string;\n  /**\n   * WARNING: If set to `true` the full card number will be returned in the `onCardChange` handler.\n   * Only do this if you're certain that you fulfill the necessary PCI compliance requirements.\n   * Make sure that you're not mistakenly logging or storing full card details!\n   * See the docs for details: https://stripe.com/docs/security/guide#validating-pci-compliance\n   */\n  dangerouslyGetFullCardDetails?: boolean;\n}\n\n/**\n *  Card Field Component\n *\n * @example\n * ```ts\n * <CardField\n *    postalCodeEnabled={false}\n *    onCardChange={(cardDetails) => {\n *    console.log('card details', cardDetails);\n *      setCard(cardDetails);\n *    }}\n *    style={{height: 50}}\n *  />\n * ```\n * @param __namedParameters Props\n * @returns JSX.Element\n * @category ReactComponents\n */\nexport const CardField = forwardRef<CardFieldInput.Methods, Props>(\n  (\n    {\n      onCardChange,\n      onFocus,\n      onBlur,\n      cardStyle,\n      placeholder,\n      postalCodeEnabled,\n      ...props\n    },\n    ref\n  ) => {\n    const inputRef = useRef<any>(null);\n\n    const onCardChangeHandler = useCallback(\n      (event: NativeSyntheticEvent<CardFieldInput.Details>) => {\n        const card = event.nativeEvent;\n\n        const data: CardFieldInput.Details = {\n          last4: card.last4,\n          expiryMonth: card.expiryMonth,\n          expiryYear: card.expiryYear,\n          complete: card.complete,\n          brand: card.brand,\n        };\n\n        if (card.hasOwnProperty('postalCode')) {\n          data.postalCode = card.postalCode || '';\n        }\n        if (card.hasOwnProperty('number')) {\n          data.number = card.number || '';\n          if (__DEV__ && onCardChange && card.complete) {\n            console.warn(\n              `[stripe-react-native] ⚠️ WARNING: You've enabled \\`dangerouslyGetFullCardDetails\\`, meaning full card details are being returned. Only do this if you're certain that you fulfill the necessary PCI compliance requirements. Make sure that you're not mistakenly logging or storing full card details! See the docs for details: https://stripe.com/docs/security/guide#validating-pci-compliance`\n            );\n          }\n        }\n        onCardChange?.(data);\n      },\n      [onCardChange]\n    );\n\n    const onFocusHandler = useCallback(\n      (event) => {\n        const { focusedField } = event.nativeEvent;\n        if (focusedField) {\n          focusInput(inputRef.current);\n          onFocus?.(focusedField);\n        } else {\n          onBlur?.();\n        }\n      },\n      [onFocus, onBlur]\n    );\n\n    const focus = () => {\n      UIManager.dispatchViewManagerCommand(\n        findNodeHandle(inputRef.current),\n        'focus' as any,\n        []\n      );\n    };\n\n    const blur = () => {\n      UIManager.dispatchViewManagerCommand(\n        findNodeHandle(inputRef.current),\n        'blur' as any,\n        []\n      );\n    };\n\n    const clear = () => {\n      UIManager.dispatchViewManagerCommand(\n        findNodeHandle(inputRef.current),\n        'clear' as any,\n        []\n      );\n    };\n\n    useImperativeHandle(ref, () => ({\n      focus,\n      blur,\n      clear,\n    }));\n\n    useLayoutEffect(() => {\n      const inputRefValue = inputRef.current;\n      if (inputRefValue !== null) {\n        registerInput(inputRefValue);\n        return () => {\n          unregisterInput(inputRefValue);\n          if (currentlyFocusedInput() === inputRefValue) {\n            inputRefValue.blur();\n          }\n        };\n      }\n      return () => {};\n    }, [inputRef]);\n\n    return (\n      <CardFieldNative\n        ref={inputRef}\n        onCardChange={onCardChangeHandler}\n        onFocusChange={onFocusHandler}\n        postalCodeEnabled={postalCodeEnabled ?? true}\n        cardStyle={{\n          backgroundColor: cardStyle?.backgroundColor,\n          borderColor: cardStyle?.borderColor,\n          borderWidth: cardStyle?.borderWidth,\n          borderRadius: cardStyle?.borderRadius,\n          cursorColor: cardStyle?.cursorColor,\n          fontSize: cardStyle?.fontSize,\n          placeholderColor: cardStyle?.placeholderColor,\n          textColor: cardStyle?.textColor,\n          textErrorColor: cardStyle?.textErrorColor,\n          fontFamily: cardStyle?.fontFamily,\n        }}\n        placeholder={{\n          number: placeholder?.number,\n          expiration: placeholder?.expiration,\n          cvc: placeholder?.cvc,\n          postalCode: placeholder?.postalCode,\n        }}\n        {...props}\n      />\n    );\n  }\n);\n"]}