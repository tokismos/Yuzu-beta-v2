{"version":3,"sources":["index.tsx"],"names":["ONE_EMPTY_DOT_SIZE","defaultEmptyDotSize","DotContainer","props","refScrollView","prevPage","curPage","getSizeRatio","sizeRatio","Math","max","scrollTo","index","animated","current","FIRST_EMPTY_DOT_SPACE","MOVE_DISTANCE","moveTo","vertical","x","y","getContainerStyle","containerSize","alignItems","flexDirection","maxHeight","undefined","maxWidth","maxPage","activeDotColor","list","Array","keys","normalizedPage","container","map","i"],"mappings":"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","sourcesContent":["/**\n *\n * Created by rouge on 11/09/2019.\n * Converted to Typescript on 14/07/2020.\n * Converted to Functional component. on 21/09/2021\n */\nimport React, { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { ScrollView, View, ViewStyle, StyleProp } from 'react-native';\nimport Dot from './component/Dot';\nimport EmptyDot, { defaultEmptyDotSize } from './component/EmptyDot';\nimport usePrevious from 'react-use/lib/usePrevious';\n\nexport interface IDotContainerProps {\n  curPage: number;\n  maxPage: number;\n  sizeRatio?: number;\n  activeDotColor: string;\n  vertical?: boolean;\n}\n\nconst ONE_EMPTY_DOT_SIZE = defaultEmptyDotSize * defaultEmptyDotSize;\n\nconst DotContainer: React.FC<IDotContainerProps> = (props) => {\n  const refScrollView = useRef<ScrollView>(null);\n  const prevPage = usePrevious(props.curPage);\n\n  const getSizeRatio = useCallback<() => number>(() => {\n    if (!props.sizeRatio) return 1.0;\n\n    return Math.max(1.0, props.sizeRatio);\n  }, [props.sizeRatio]);\n\n  const scrollTo = useCallback<(index: number, animated?: boolean) => void>(\n    (index, animated = true) => {\n      if (!refScrollView.current) return;\n\n      const sizeRatio = getSizeRatio();\n      const FIRST_EMPTY_DOT_SPACE = ONE_EMPTY_DOT_SIZE * 2;\n      const MOVE_DISTANCE = ONE_EMPTY_DOT_SIZE * sizeRatio;\n\n      const moveTo = Math.max(\n        0,\n        FIRST_EMPTY_DOT_SPACE + (index - 4) * MOVE_DISTANCE\n      );\n\n      if (props.vertical) {\n        refScrollView.current.scrollTo({\n          x: 0,\n          y: moveTo,\n          animated,\n        });\n        return;\n      }\n\n      refScrollView.current.scrollTo({\n        x: moveTo,\n        y: 0,\n        animated,\n      });\n    },\n    [getSizeRatio, props.vertical]\n  );\n\n  const getContainerStyle = useCallback<() => StyleProp<ViewStyle>>(() => {\n    const { vertical } = props;\n    const sizeRatio = getSizeRatio();\n    const containerSize = 84 * sizeRatio;\n\n    return {\n      alignItems: 'center',\n      flexDirection: vertical ? 'column' : 'row',\n      maxHeight: vertical ? containerSize : undefined,\n      maxWidth: vertical ? undefined : containerSize,\n    };\n  }, [getSizeRatio, props]);\n\n  useEffect(() => {\n    if (props.maxPage > 4 && prevPage !== props.curPage)\n      scrollTo(props.curPage);\n  }, [prevPage, props.curPage, props.maxPage, scrollTo]);\n\n  const { curPage, maxPage, activeDotColor } = props;\n  const list = useMemo(() => [...Array(maxPage).keys()], [maxPage]);\n\n  let normalizedPage = curPage;\n  if (curPage < 0) {\n    normalizedPage = 0;\n  }\n\n  if (curPage > maxPage - 1) {\n    normalizedPage = maxPage - 1;\n  }\n  const sizeRatio = getSizeRatio();\n\n  const container = getContainerStyle();\n\n  if (maxPage < 5) {\n    return (\n      <View style={container}>\n        {list.map((i) => {\n          return (\n            <Dot\n              key={i}\n              idx={i}\n              sizeRatio={sizeRatio}\n              curPage={normalizedPage}\n              maxPage={maxPage}\n              activeColor={activeDotColor}\n            />\n          );\n        })}\n      </View>\n    );\n  }\n\n  return (\n    <View\n      style={container}\n      onLayout={() => {\n        // scroll to right index on initial render\n        scrollTo(props.curPage, false);\n      }}\n    >\n      <ScrollView\n        ref={refScrollView}\n        contentContainerStyle={{\n          alignItems: 'center',\n        }}\n        bounces={false}\n        horizontal={!props.vertical}\n        scrollEnabled={false}\n        showsVerticalScrollIndicator={false}\n        showsHorizontalScrollIndicator={false}\n      >\n        {/* previous empty dummy dot */}\n        <EmptyDot sizeRatio={sizeRatio} />\n        <EmptyDot sizeRatio={sizeRatio} />\n\n        {list.map((i) => {\n          return (\n            <Dot\n              sizeRatio={sizeRatio}\n              key={i}\n              idx={i}\n              curPage={normalizedPage}\n              maxPage={maxPage}\n              activeColor={activeDotColor}\n            />\n          );\n        })}\n\n        {/* previous empty dummy dot */}\n        <EmptyDot sizeRatio={sizeRatio} />\n        <EmptyDot sizeRatio={sizeRatio} />\n      </ScrollView>\n    </View>\n  );\n};\n\nexport default DotContainer;\n"]}